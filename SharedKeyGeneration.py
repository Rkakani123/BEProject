def SharedKeyGeneration(PrivateKey,PublicKey,i):

    ModDefault = 72096664835399559436811434969384345032130523094927619960950802945506132907406
    Mod128 = 285392000526754704085259323840045074447
    Mod160 = 211065013311311100224440023540065448264012145490
    Mod256 = 95245222997991701934146083506505579955710543748649557515729968425896875220278
    Mod512 = 12401872348569841401057151482777810304587630198360347730642181166110698429439981650646249842977108143110089070212424030982006547926832047351713081459751358

    if (i <= 128):
        mod = Mod128
    elif (i <= 160):
        mod = Mod160
    elif (i <= 256):
        mod = Mod256
    elif (i <= 512):
        mod = Mod512
    else:
        mod = ModDefault
        i = 256;

    SharedKey = pow( PublicKey , PrivateKey , mod )

    return SharedKey